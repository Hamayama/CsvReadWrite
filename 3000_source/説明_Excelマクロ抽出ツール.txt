＜Excelマクロ抽出ツール＞


1.概要
  Excelファイルのマクロのソースをエクスポートするツールです。
  (基本的に確認用です)


2.事前準備
  (1)Excelの設定
     Excelのオプション設定で、セキュリティセンター(またはトラストセンター)の設定を開き、
     「マクロの設定」-「VBA プロジェクト オブジェクト モデルへのアクセスを信頼する」
     にチェックを入れてください。
     (この設定をしないと、アクセス権のエラーが発生します)

  (2)1000_export_macro.bat をメモ帳等で開いて、
     EXCEL_FILE1 に、Excelファイル名を指定します。
     EXPORT_FOLDER1 に、マクロのソースを書き出すフォルダ名を指定します。


3.実行方法
  1000_export_macro.bat を実行すると、マクロのソースが出力されます。


4.その他
  ・v1.05 から、Accessファイル (拡張子が .mdb のファイル) のマクロのソースも
    エクスポート可能になりました。

  ・Excelファイルのパス名に日本語がある場合、以下のエラーが出ることがあります。
    「未知の実行時エラーです。: 'objExcel.Workbooks.Open'
      コード : 800A03EC
      ソース : Microsoft VBScript 実行時エラー」
    この場合、フォルダ名やファイル名を、短い英数字のみにしてみてください。
    また、このエラーが出ると、Excelが終了しないため、タスクマネージャから終了してください。


(2020-12-21)(2021-1-7)(2022-3-23)(2024-4-22)(2025-3-26)
(2025-7-22)
